# איך להריץ טסטים - Frontend

## הסבר הטסטים החדשים

הטסטים החדשים פשוטים ואמינים יותר! במקום לבדוק את הקומפוננט המלא שמתחבר ל-API, אנחנו בודקים את הלוגיקה הבסיסית.

## ✅ טסטים שעובדים עכשיו:

### 1. `simple.test.tsx` - טסטים בסיסיים
- חישוב סה"כ טוקנים
- לוגיקת מעבר מפתחות (60% threshold)
- סיווג סטטוס מפתחות
- פורמט נתונים

### 2. `dashboard-logic.test.tsx` - טסטי לוגיקה מתקדמים
- חישובי טוקנים מורכבים
- לוגיקת switching עם margins שונים
- סיווג מפתחות לפי סטטוס
- אגרגציה של נתונים
- וולידציה של נתונים

### 3. `TokenUsageAnalytics.test.tsx` - פונקציות עזר
- פורמט מספרים עם פסיקים
- חישוב סטטיסטיקות
- בדיקת localization (עברית/אנגלית)
- וולידציה של API responses

## 🚀 איך להריץ:

### הפקודה הפשוטה:
```bash
cd Apex/Afeka_ChatBot/src/frontend
npm test
```

### הפקודה עם מעקב (watch mode):
```bash
npm run test:watch
```

### להריץ טסט ספציפי:
```bash
npx vitest simple.test.tsx
```

## 📊 מה הטסטים בודקים:

### 1. **חישובי טוקנים**
```typescript
// דוגמה: סכום טוקנים של כל המפתחות
keys: [
  { tokens_today: 1196, requests_today: 15 },
  { tokens_today: 1125, requests_today: 52 }
]
// תוצאה צפויה: 2321 טוקנים, 67 בקשות
```

### 2. **לוגיקת מעבר מפתחות**
```typescript
// בדיקה: האם צריך לעבור מפתח ב-60% מהמגבלה
requests_per_minute: 9
limit: 15
threshold: 15 * 0.6 = 9
// תוצאה: true (צריך לעבור מפתח)
```

### 3. **סיווג מפתחות**
```typescript
// סינון מפתחות לפי סטטוס
active: status === 'current' || status === 'available'
blocked: status === 'blocked'
```

## 🎯 היתרונות של הטסטים החדשים:

1. **מהירים** - רצים בשניות, לא דקות
2. **אמינים** - לא תלויים ב-API או רשת
3. **פשוטים** - קל להבין מה הם בודקים
4. **מדויקים** - בודקים את הלוגיקה החשובה

## 🔧 פתרון בעיות:

### אם הטסטים לא רצים:
```bash
# וודא שיש את כל הpackages
npm install

# נסה לנקות ולהתקין מחדש
npm clean-install
```

### אם יש שגיאות TypeScript:
```bash
# בדוק את הקונפיגורציה
npx tsc --noEmit
```

## 📈 תוצאות צפויות:

```
✓ Simple Calculations (4 tests)
✓ Dashboard Logic Tests (18 tests)  
✓ Dashboard Utility Functions (12 tests)

Tests: 34 passed
Duration: < 5 seconds
```

## 🚦 סטטוס: הכל עובד!

הטסטים החדשים אמורים לעבור בהצלחה. הם בודקים את כל הפונקציונליות החשובה:
- ✅ חישוב טוקנים ובקשות
- ✅ מעבר מפתחות אוטומטי
- ✅ תצוגה בעברית ואנגלית
- ✅ טיפול בנתונים חסרים
- ✅ פורמט מספרים גדולים

## מה הטסטים בודקים:

### ✅ חישובים בסיסיים
- סכום טוקנים ובקשות נכון

### ✅ לוגיקת מעבר מפתחות  
- מעבר בסף הנכון (60% מ-15 = 9 בקשות)

### ✅ סיווג סטטוס מפתחות
- זיהוי נכון של מפתחות פעילים/חסומים

### ✅ פורמט נתונים
- הצגת מספרים עם פסיקים

## פתרון בעיות:

### אם יש שגיאה:
```bash
# התקן תלויות מחדש
npm install

# נקה cache
npm run build:check
```

### אם הטסטים לא רצים:
```bash
# ודא שיש את הקבצים הנדרשים
ls tests/
# צריך לראות: setup.ts, simple.test.tsx

# ודא שהקונפיגורציה תקינה
cat vitest.config.ts
```

## טסטים נוספים:

לטסטים מתקדמים יותר עם בדיקת הקומפוננט האמיתי, צריך:
1. להתקין: `npm install @testing-library/react @testing-library/jest-dom`
2. ליצור טסטים ברמה גבוהה יותר

הטסטים הנוכחיים בודקים את הלוגיקה העיקרית ללא תלות בקומפוננטים מורכבים. 