# ×¤×¨×•××˜ 1.2: × ×™×§×•×™ src/ai/core/gemini_key_manager.py

## ××˜×¨×”

× ×™×§×•×™ ×”×¢×¨×•×ª ×‘×¢×‘×¨×™×ª, ×”×¢×¨×•×ª DEBUG ×•×”×“×¤×¡×•×ª ××™×•×ª×¨×•×ª ××”×§×•×‘×¥.

## ×©×™× ×•×™×™× × ×“×¨×©×™×:

### 1. ×”×¡×¨×ª ×›×•×ª×¨×ª ×‘×¢×‘×¨×™×ª

- ×©×•×¨×” 1: `"""×× ×’× ×•×Ÿ × ×™×”×•×œ ××¤×ª×—×•×ª ×’××™× ×™ - ×¤×ª×¨×•×Ÿ ××™× ×™××œ×™"""` â†’ `"""Gemini API key management system"""`

### 2. ×”×¡×¨×ª ×”×¢×¨×•×ª ×‘×¢×‘×¨×™×ª

- ×©×•×¨×” 14: `"""×× ×’× ×•×Ÿ ×¤×©×•×˜ ×œ× ×™×”×•×œ ××¤×ª×—×•×ª ×’××™× ×™"""` â†’ `"""Simple Gemini API key management system"""`
- ×©×•×¨×” 31: `# ğŸ”„ ×©× ×” ×–××ª: ×‘×“×œ×” fallback ×œ-.env ×× ×“××˜×” ×‘×™×™×¡ ×œ× ×–××™×Ÿ` â†’ ×”×¡×¨
- ×©×•×¨×” 37: `# Initialize usage tracking for each key` â†’ ×©××•×¨ (×‘×× ×’×œ×™×ª)
- ×©×•×¨×” 55: `"""×˜×¢×™× ×ª ××¤×ª×—×•×ª ×¢× fallback ×œ-.env"""` â†’ `"""Load keys with fallback to .env"""`
- ×©×•×¨×” 57: `# ğŸ†• × ×¡×” ×œ×˜×¢×•×Ÿ ×™×©×™×¨×•×ª ××“××˜×” ×‘×™×™×¡ (×œ×œ× ×ª×œ×•×ª ×‘×‘×§×× ×“)` â†’ ×”×¡×¨
- ×©×•×¨×” 70: `# Fallback ×œ-.env` â†’ `# Fallback to .env`

### 3. ×”×¡×¨×ª ×”×¢×¨×•×ª DEBUG ××¤×•×¨×˜×•×ª

- ×©×•×¨×” 189: `# ğŸ” DEBUG: ×œ×•×’×™× ××¤×•×¨×˜×™×` â†’ ×”×¡×¨
- ×©×•×¨×” 580: `# ğŸ” DEBUG: ××™×“×¢ ××¤×•×¨×˜ ×¢×œ ×”-instance` â†’ ×”×¡×¨
- ×©×•×¨×•×ª 239-245: ×”×¢×¨×•×ª DEBUG ××¤×•×¨×˜×•×ª â†’ ×¨×§ ×”×¢×¨×” ×§×¦×¨×” ×‘×× ×’×œ×™×ª

### 4. ×”×¡×¨×ª print statements ××™×•×ª×¨×•×ª

- ×©×•×¨×” 68: `print(f"ğŸ”‘ Loaded {len(self.api_keys)} keys from database")` â†’ ×œ×•×’ logger ×‘××§×•×
- ×©×•×¨×” 83: `print(f"ğŸ”‘ Loaded {len(self.api_keys)} keys from .env")` â†’ ×œ×•×’ logger ×‘××§×•×
- ×©×•×¨×” 94: `print(f"ğŸ”‘ Loaded {len(self.api_keys)} keys from database")` â†’ ×œ×•×’ logger ×‘××§×•×

### 5. ×”×—×œ×¤×ª ×”×¢×¨×•×ª ×¢×‘×¨×™×•×ª ×‘×¤×•× ×§×¦×™×•×ª

- `_load_keys_from_env`: `"""×˜×¢×™× ×ª ××¤×ª×—×•×ª ×-.env (fallback)"""` â†’ `"""Load keys from .env (fallback)"""`
- `_load_keys_from_database`: `"""×˜×¢×™× ×ª ××¤×ª×—×•×ª ××“××˜×” ×‘×™×™×¡"""` â†’ `"""Load keys from database"""`
- `get_next_available_key`: `"""×§×‘×œ×ª ××¤×ª×— ×–××™×Ÿ ×”×‘×"""` â†’ `"""Get next available key"""`
- `_configure_current_key`: `"""×”×’×“×¨×ª ×”××¤×ª×— ×”× ×•×›×—×™ ×‘-genai"""` â†’ `"""Configure current key in genai"""`
- `_reset_counters_if_needed`: `"""××™×¤×•×¡ ××•× ×™× ×œ×¤×™ ×–××Ÿ"""` â†’ `"""Reset counters based on time"""`
- `_check_limits`: `"""×‘×“×™×§×” ×”×× ×”××¤×ª×— ×–××™×Ÿ"""` â†’ `"""Check if key is available"""`
- `_find_available_key`: `"""××¦×™××ª ××¤×ª×— ×–××™×Ÿ"""` â†’ `"""Find available key"""`
- `track_usage`: `"""×¢×“×›×•×Ÿ ×©×™××•×© ×œ××—×¨ ×‘×§×©×”"""` â†’ `"""Update usage after request"""`

### 6. × ×™×§×•×™ ×”×¢×¨×•×ª ×‘×ª×•×š ×”×¤×•× ×§×¦×™×•×ª

- ×”×¡×¨ ×”×¢×¨×•×ª ×›××•: `# ××™×¤×•×¡ ×“×§×”`, `# ××™×¤×•×¡ ×™×•×`, `# ×‘×“×™×§×ª ×—×¡×™××”`
- ×”×—×œ×£ ×‘×”×¢×¨×•×ª ×§×¦×¨×•×ª ×‘×× ×’×œ×™×ª ××• ×”×¡×¨ ×œ×’××¨×™

## ××—×¨×™ ×”×©×™× ×•×™×™×:

- ×”×§×•×‘×¥ ×¦×¨×™×š ×œ×”×™×¨××•×ª ××§×¦×•×¢×™ ×¢× ×”×¢×¨×•×ª ××™×›×•×ª×™×•×ª ×‘×× ×’×œ×™×ª ×‘×œ×‘×“
- ×©××•×¨ ×¢×œ ×›×œ ×”×¤×•× ×§×¦×™×•× ×œ×™×•×ª
- ××œ ×ª×©× ×” ×©××•×ª ××©×ª× ×™×, ×§×œ××¡×™× ××• ×¤×•× ×§×¦×™×•×ª
